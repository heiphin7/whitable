<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ru">
<head>
    <meta charset="UTF-8" />
    <title>Whitable — Вход и регистрация</title>
    <link rel="stylesheet" th:href="@{/css/auth.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body>
<header class="auth-header">
    <nav class="nav-container">
        <a th:href="@{/}" class="logo">Whitable</a>
    </nav>
</header>

<main class="auth-container">
    <div class="auth-box">
        <div class="auth-tabs">
            <button class="tab-btn" data-tab="login"
                    th:classappend="${action} == 'login' ? ' active' : ''">
                Вход
            </button>
            <button class="tab-btn" data-tab="register"
                    th:classappend="${action} == 'registration' ? ' active' : ''">
                Регистрация
            </button>
        </div>

        <div class="flash-messages space-y-3 text-center mx-auto" style="margin-bottom: 15px; max-width: 400px;">
            <div
                    class="success-message bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative"
                    role="alert"
                    th:if="${successMessage != null}">
                <span class="block font-semibold" th:text="${successMessage}"></span>
            </div>
            <div
                    class="error-message bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative"
                    role="alert"
                    th:if="${errorMessage != null}">
                <span class="block font-semibold" th:text="${errorMessage}"></span>
            </div>
        </div>

        <!-- Форма входа -->
        <form id="loginForm"
              class="auth-form"
              th:classappend="${action} == 'login' ? ' active' : ''"
              th:action="@{/login}"
              method="post"
              novalidate>

            <div class="form-group">
                <label for="loginEmail">Электронная почта</label>
                <input
                        type="email"
                        id="loginEmail"
                        name="email"
                        required
                        placeholder="Введите email"
                        th:value="${dto?.email}">
                <span class="error-message"></span>
            </div>

            <div class="form-group">
                <label for="loginPassword">Пароль</label>
                <div class="password-input">
                    <input
                            type="password"
                            id="loginPassword"
                            name="password"
                            required
                            placeholder="Введите пароль">
                    <button type="button" class="toggle-password">
                        <i class="far fa-eye"></i>
                    </button>
                </div>
                <span class="error-message"></span>
            </div>

            <div class="form-group checkbox">
                <input type="checkbox" id="rememberMe">
                <label for="rememberMe">Запомнить меня</label>
            </div>

            <button type="submit" class="auth-button" disabled>Войти</button>
        </form>

        <!-- Форма регистрации -->
        <form id="registerForm"
              class="auth-form"
              th:classappend="${action} == 'registration' ? ' active' : ''"
              th:action="@{/registration}"
              method="post"
              novalidate>

            <div class="form-group">
                <label for="registerName">Имя и фамилия</label>
                <input
                        type="text"
                        id="registerName"
                        name="username"
                        required
                        placeholder="Введите имя и фамилию"
                        th:value="${dto?.username}">
                <span class="error-message"></span>
            </div>

            <div class="form-group">
                <label for="registerEmail">Электронная почта</label>
                <input
                        type="email"
                        id="registerEmail"
                        name="email"
                        required
                        placeholder="Введите email"
                        th:value="${dto?.email}">
                <span class="error-message"></span>
            </div>

            <div class="form-group">
                <label for="registerPassword">Пароль</label>
                <div class="password-input">
                    <input
                            type="password"
                            id="registerPassword"
                            name="password"
                            required
                            placeholder="Придумайте пароль">
                    <button type="button" class="toggle-password">
                        <i class="far fa-eye"></i>
                    </button>
                </div>
                <span class="error-message"></span>
            </div>

            <div class="form-group">
                <label for="confirmPassword">Подтвердите пароль</label>
                <div class="password-input">
                    <input
                            type="password"
                            id="confirmPassword"
                            name="confirmPassword"
                            required
                            placeholder="Подтвердите пароль">
                    <button type="button" class="toggle-password">
                        <i class="far fa-eye"></i>
                    </button>
                </div>
                <span class="error-message"></span>
            </div>

            <div class="form-group checkbox">
                <input type="checkbox" id="termsAccept" required>
                <label for="termsAccept">Я принимаю <a href="#">Условия использования</a> и <a href="#">Политику конфиденциальности</a></label>
                <span class="error-message"></span>
            </div>

            <button type="submit" class="auth-button" disabled>Создать аккаунт</button>
        </form>
    </div>
</main>

<footer class="auth-footer">
    <div class="footer-content">
        <p>&copy; 2025 Whitable. Все права защищены.</p>
        <div class="footer-links">
            <a href="#">Политика конфиденциальности</a>
            <a href="#">Условия использования</a>
            <a href="#">Центр помощи</a>
            <a href="#">Связаться с поддержкой</a>
        </div>
    </div>
</footer>

<script>
    var action = '[(${action})]';

    function setActiveTab(tabName) {
        const tabBtns = document.querySelectorAll('.tab-btn');
        const forms = document.querySelectorAll('.auth-form');
        tabBtns.forEach(b => b.classList.remove('active'));
        forms.forEach(f => f.classList.remove('active'));
        document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
        document.getElementById(`${tabName}Form`).classList.add('active');
    }

    window.onload = function() {
        if (action === "login") {
            setActiveTab("login");
        } else if (action === "registration") {
            setActiveTab("register");
        }
    };
</script>
<script th:src="@{/js/auth.js}" type="module"></script>
</body>
</html>
