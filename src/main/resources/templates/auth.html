<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Whitable - Sign In or Register</title>
    <link rel="stylesheet" th:href="@{/css/auth.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body>
<header class="auth-header">
    <nav class="nav-container">
        <a th:href="@{/}" class="logo">Whitable</a>
        <div class="nav-right">
            <a th:href="@{/}" class="back-link"><i class="fas fa-arrow-left"></i> Back to Home</a>
        </div>
    </nav>
</header>

<main class="auth-container">
    <div class="auth-box">
        <div class="auth-tabs">
            <button class="tab-btn" data-tab="login"
                    th:classappend="${action} == 'login' ? ' active' : ''">
                Sign In
            </button>
            <button class="tab-btn" data-tab="register"
                    th:classappend="${action} == 'registration' ? ' active' : ''">
                Register
            </button>
        </div>

        <!-- Если есть errorMessage или successMessage, выводим их -->
        <div class="flash-messages space-y-3 text-center mx-auto" style="margin-bottom: 15px; max-width: 400px;">
            <div
                    class="success-message bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative"
                    role="alert"
                    th:if="${successMessage != null}">
                <span class="block font-semibold" th:text="${successMessage}"></span>
            </div>
            <div
                    class="error-message bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative"
                    role="alert"
                    th:if="${errorMessage != null}">
                <span class="block font-semibold" th:text="${errorMessage}"></span>
            </div>
        </div>


        <!-- Login Form -->
        <form id="loginForm"
              class="auth-form"
              th:classappend="${action} == 'login' ? ' active' : ''"
              th:action="@{/login}"
              method="post"
              novalidate>

            <!-- Поля AuthDto: email, password -->
            <div class="form-group">
                <label for="loginEmail">Email Address</label>
                <input
                        type="email"
                        id="loginEmail"
                        name="email"
                        required
                        placeholder="Enter your email"
                        th:value="${dto?.email}">
                <span class="error-message"></span>
            </div>

            <div class="form-group">
                <label for="loginPassword">Password</label>
                <div class="password-input">
                    <input
                            type="password"
                            id="loginPassword"
                            name="password"
                            required
                            placeholder="Enter your password">
                    <button type="button" class="toggle-password">
                        <i class="far fa-eye"></i>
                    </button>
                </div>
                <span class="error-message"></span>
            </div>

            <div class="form-group checkbox">
                <input type="checkbox" id="rememberMe">
                <label for="rememberMe">Remember me</label>
            </div>

            <button type="submit" class="auth-button" disabled>Sign In</button>

            <div class="form-footer">
                <a href="#" class="forgot-password">Forgot Password?</a>
            </div>
        </form>

        <!-- Register Form -->
        <form id="registerForm"
              class="auth-form"
              th:classappend="${action} == 'registration' ? ' active' : ''"
              th:action="@{/registration}"
              method="post"
              novalidate>

            <!-- Поля CreateUserDto: username, email, password -->
            <div class="form-group">
                <label for="registerName">Full Name</label>
                <input
                        type="text"
                        id="registerName"
                        name="username"
                        required
                        placeholder="Enter your full name"
                        th:value="${dto?.username}">
                <span class="error-message"></span>
            </div>

            <div class="form-group">
                <label for="registerEmail">Email Address</label>
                <input
                        type="email"
                        id="registerEmail"
                        name="email"
                        required
                        placeholder="Enter your email"
                        th:value="${dto?.email}">
                <span class="error-message"></span>
            </div>

            <div class="form-group">
                <label for="registerPassword">Password</label>
                <div class="password-input">
                    <input
                            type="password"
                            id="registerPassword"
                            name="password"
                            required
                            placeholder="Create a password">
                    <button type="button" class="toggle-password">
                        <i class="far fa-eye"></i>
                    </button>
                </div>
                <span class="error-message"></span>
            </div>

            <div class="form-group">
                <label for="confirmPassword">Confirm Password</label>
                <div class="password-input">
                    <input
                            type="password"
                            id="confirmPassword"
                            name="confirmPassword"
                            required
                            placeholder="Confirm your password">
                    <button type="button" class="toggle-password">
                        <i class="far fa-eye"></i>
                    </button>
                </div>
                <span class="error-message"></span>
            </div>

            <div class="form-group checkbox">
                <input type="checkbox" id="termsAccept" required>
                <label for="termsAccept">I accept the <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a></label>
                <span class="error-message"></span>
            </div>

            <button type="submit" class="auth-button" disabled>Create Account</button>
        </form>
    </div>
</main>

<footer class="auth-footer">
    <div class="footer-content">
        <p>&copy; 2024 Whitable. All rights reserved.</p>
        <div class="footer-links">
            <a href="#">Privacy Policy</a>
            <a href="#">Terms of Service</a>
            <a href="#">Help Center</a>
            <a href="#">Contact Support</a>
        </div>
    </div>
</footer>
<script>
    // Получаем переменную action с бэкенда через Thymeleaf
    var action = '[(${action})]';
    console.log("Action: " + action);

    // Функция переключения активного окна
    function setActiveTab(tabName) {
        const tabBtns = document.querySelectorAll('.tab-btn');
        const forms = document.querySelectorAll('.auth-form');
        tabBtns.forEach(b => b.classList.remove('active'));
        forms.forEach(f => f.classList.remove('active'));
        document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
        document.getElementById(`${tabName}Form`).classList.add('active');
    }

    window.onload = function() {
        if (action === "login") {
            setActiveTab("login");
        } else if (action === "registration") {
            setActiveTab("register");
        }
    };
</script>
<script th:src="@{/js/auth.js}" type="module"></script>
</body>
</html>